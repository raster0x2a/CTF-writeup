<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>DiceCTF2021s :: CTF Writeups</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/dicectf2021/" />




<link rel="stylesheet" href="assets/style.css">

  <link rel="stylesheet" href="assets/%25!s%28%3cnil%3e%29.css">






<link rel="apple-touch-icon" href="img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="img/favicon/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="DiceCTF2021s">
<meta property="og:description" content="" />
<meta property="og:url" content="/dicectf2021/" />
<meta property="og:site_name" content="CTF Writeups" />

  
    <meta property="og:image" content="img/favicon/%!s().png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">





  <link href="/dicectf2021/index.xml" rel="alternate" type="application/rss+xml" title="CTF Writeups" />









</head>
<body class="">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
  </div>
  
</header>


  <div class="content">
    
  
  <div class="posts">
    
      <div class="post on-list">
        <h1 class="post-title">
          <a href="/dicectf2021/babiercsp/"></a>
        </h1>
        <div class="post-meta">
          <span class="post-date">
            0001-01-01
          </span>
          
        </div>

        

        


      
        <div class="post-content">
          
            web/Babier CSP 問題 babier-csp.dicec.tf
Admin Bot
The admin will set a cookie secret equal to config.secret in index.js.
解説 まず babier-csp.dicec.tf は name に渡された文字列をそのまま表示させています。そのため XSS が期待できますが、 &lt;script&gt;alert(&lsquo;ok&rsquo;)&lt;/script&gt; などを直接入れても以下のように怒られます。
Refused to execute inline script because it violates the following Content Security Policy directive: &quot;script-src 'nonce-LRGWAXOY98Es0zz0QOVmag=='&quot;. Either the 'unsafe-inline' keyword, a hash ('sha256-GhSELej6D4No8Cu4c6BlA7SQooAXc4iM9HQ5s9uW7Gw='), or a nonce ('nonce-&hellip;') is required to enable inline execution. script タグの nonce 属性には、CSP(Content Security Policy) によって JavaScript の実行を制限し、XSS などを防ぐ機能があります。しかし nonce の値が予測できてしまえば意味をなさないため、本来はリクエストごとにランダムな文字列を生成しなければならないのですが、このページでは LRGWAXOY98Es0zz0QOVmag== で固定されています。そのため &lt;script nonce=LRGWAXOY98Es0zz0QOVmag==&gt;hoge&lt;/script&gt; という形式で怒られずに任意のスクリプトをインジェクションできます。
          
        </div>

        
        <div>
          <a class="read-more button"
            href="/dicectf2021/babiercsp/"> →</a>
        </div>
        
      </div>
    
    <div class="pagination">
  <div class="pagination__buttons">
    
    
  </div>
</div>

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="assets/main.js"></script>
<script src="assets/prism.js"></script>







  
</div>

</body>
</html>
